<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <title>4-6. ì‹œë®¬ë ˆì´ì…˜, êµ¬í˜„, ë¶€ë¡ - RISC-V Pipeline Processor</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700&display=swap');

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans KR', sans-serif;
            font-size: 11pt;
            line-height: 1.8;
            max-width: 210mm;
            margin: 0 auto;
            padding: 20mm;
        }

        h1 {
            font-size: 18pt;
            margin: 30px 0 20px;
            border-bottom: 2px solid #000;
            padding-bottom: 10px;
        }

        h2 {
            font-size: 14pt;
            margin: 25px 0 15px;
        }

        h3 {
            font-size: 12pt;
            margin: 20px 0 10px;
        }

        p {
            margin: 10px 0;
            text-align: justify;
            text-indent: 1em;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            font-size: 10pt;
        }

        th,
        td {
            border: 1px solid #000;
            padding: 8px;
            text-align: center;
        }

        th {
            background: #f0f0f0;
        }

        td.left {
            text-align: left;
        }

        .caption {
            text-align: center;
            font-size: 10pt;
            margin: 10px 0;
            font-weight: bold;
        }

        pre {
            background: #f5f5f5;
            padding: 15px;
            font-size: 9pt;
            line-height: 1.4;
            overflow-x: auto;
            border: 1px solid #ddd;
        }

        ul,
        ol {
            margin: 15px 0 15px 30px;
        }

        li {
            margin: 8px 0;
        }

        .page-num {
            text-align: center;
            font-size: 10pt;
            margin: 30px 0;
            color: #666;
        }

        .highlight {
            background: #fff3cd;
            padding: 15px;
            border-left: 4px solid #ffc107;
            margin: 20px 0;
        }

        .error {
            background: #f8d7da;
            padding: 15px;
            border-left: 4px solid #dc3545;
            margin: 20px 0;
        }

        .success {
            background: #d4edda;
            padding: 15px;
            border-left: 4px solid #28a745;
            margin: 20px 0;
        }

        @media print {
            .page-break {
                page-break-before: always;
            }
        }
    </style>
</head>

<body>

    <div class="page-num">- 18 -</div>

    <h1>4. ì‹œë®¬ë ˆì´ì…˜</h1>

    <h2>4.1 í…ŒìŠ¤íŠ¸ë²¤ì¹˜ ì†ŒìŠ¤</h2>

    <pre>
`timescale 1ns / 1ps

module tb_top();
    reg clk, rst;
    reg switch_0;
    reg ps2_clk, ps2_data;
    wire vga_hsync, vga_vsync;
    wire [3:0] vga_r, vga_g, vga_b;
    wire [6:0] seg_out;
    wire [7:0] seg_sel;
    wire led_heartbeat;
    wire [15:0] led;
    
    // DUT Instantiation
    top dut (
        .clk(clk),
        .rst(rst),
        .switch_0(switch_0),
        .ps2_clk(ps2_clk),
        .ps2_data(ps2_data),
        .vga_hsync(vga_hsync),
        .vga_vsync(vga_vsync),
        .vga_r(vga_r),
        .vga_g(vga_g),
        .vga_b(vga_b),
        .seg_out(seg_out),
        .seg_sel(seg_sel),
        .led_heartbeat(led_heartbeat),
        .led(led)
    );
    
    // Clock Generation: 100MHz (10ns period)
    initial clk = 0;
    always #5 clk = ~clk;
    
    // Reset Sequence
    initial begin
        rst = 0;        // Assert reset (Active-Low)
        switch_0 = 0;
        ps2_clk = 1;
        ps2_data = 1;
        #100;
        rst = 1;        // Release reset
        #1000000;       // Run simulation
        $finish;
    end
    
    // Monitor PC and Instruction
    always @(posedge clk) begin
        if (rst) begin
            $display("Time=%0t PC=%h Inst=%h", $time, dut.PC, dut.inst_out);
        end
    end
endmodule
</pre>
    <p class="caption">[ì½”ë“œ 4-1] í…ŒìŠ¤íŠ¸ë²¤ì¹˜ ì†ŒìŠ¤</p>

    <div class="page-break"></div>
    <div class="page-num">- 19 -</div>

    <h2>4.2 ê²°ê³¼ Waveform ë° í•´ì„¤</h2>

    <p>
        Vivado Behavioral Simulationì„ í†µí•´ ë‹¤ìŒ ì‚¬í•­ë“¤ì„ ê²€ì¦í•˜ì˜€ë‹¤:
    </p>

    <table>
        <tr>
            <th>ê²€ì¦ í•­ëª©</th>
            <th>ì˜ˆìƒ ë™ì‘</th>
            <th>ê²°ê³¼</th>
        </tr>
        <tr>
            <td class="left">PC ì¦ê°€</td>
            <td class="left">ë§¤ í´ëŸ­ë§ˆë‹¤ PC += 4</td>
            <td>âœ… ì •ìƒ</td>
        </tr>
        <tr>
            <td class="left">ëª…ë ¹ì–´ Fetch</td>
            <td class="left">BRAMì—ì„œ ì˜¬ë°”ë¥¸ ëª…ë ¹ì–´ ì½ê¸°</td>
            <td>âœ… ì •ìƒ</td>
        </tr>
        <tr>
            <td class="left">Heartbeat LED</td>
            <td class="left">ì•½ 0.75Hz ì ë©¸</td>
            <td>âœ… ì •ìƒ</td>
        </tr>
        <tr>
            <td class="left">VGA Timing</td>
            <td class="left">HSYNC/VSYNC ì‹ í˜¸ ìƒì„±</td>
            <td>âœ… ì •ìƒ</td>
        </tr>
        <tr>
            <td class="left">7-Segment Mux</td>
            <td class="left">seg_sel ìˆœì°¨ í™œì„±í™”</td>
            <td>âœ… ì •ìƒ</td>
        </tr>
    </table>
    <p class="caption">[í‘œ 4-1] ì‹œë®¬ë ˆì´ì…˜ ê²€ì¦ ê²°ê³¼</p>

    <div class="highlight">
        <strong>ğŸ’¡ ì°¸ê³ :</strong> PS2 í‚¤ë³´ë“œ ì…ë ¥ ì‹œë®¬ë ˆì´ì…˜ì€ PS2 í”„ë¡œí† ì½œì˜ ë³µì¡ì„±ìœ¼ë¡œ ì¸í•´ í•˜ë“œì›¨ì–´ í…ŒìŠ¤íŠ¸ë¡œ ëŒ€ì²´í•˜ì˜€ë‹¤.
    </div>

    <div class="page-break"></div>
    <div class="page-num">- 20 -</div>

    <h1>5. êµ¬í˜„</h1>

    <h2>5.1 ê¸°ëŠ¥ êµ¬í˜„ ë‹¬ì„± ì—¬ë¶€</h2>

    <table>
        <tr>
            <th>ëª©í‘œ ê¸°ëŠ¥</th>
            <th>êµ¬í˜„ ì—¬ë¶€</th>
            <th>ë¹„ê³ </th>
        </tr>
        <tr>
            <td class="left">5-Stage RISC-V Pipeline</td>
            <td>âœ… ì™„ë£Œ</td>
            <td class="left">RV32I ëª…ë ¹ì–´ ì§€ì›</td>
        </tr>
        <tr>
            <td class="left">Data Forwarding</td>
            <td>âœ… ì™„ë£Œ</td>
            <td class="left">EX/MEM, MEM/WB í¬ì›Œë”©</td>
        </tr>
        <tr>
            <td class="left">Hazard Detection & Stall</td>
            <td>âœ… ì™„ë£Œ</td>
            <td class="left">Load-Use Hazard ì²˜ë¦¬</td>
        </tr>
        <tr>
            <td class="left">PS2 í‚¤ë³´ë“œ ì…ë ¥</td>
            <td>âœ… ì™„ë£Œ</td>
            <td class="left">0-9, Enter, Backspace</td>
        </tr>
        <tr>
            <td class="left">Number Input Buffer</td>
            <td>âœ… ì™„ë£Œ</td>
            <td class="left">ìµœëŒ€ 8ìë¦¬ ì§€ì›</td>
        </tr>
        <tr>
            <td class="left">VGA ODD/EVEN í‘œì‹œ</td>
            <td>âœ… ì™„ë£Œ</td>
            <td class="left">640Ã—480, ë¹„íŠ¸ë§µ í°íŠ¸</td>
        </tr>
        <tr>
            <td class="left">7-Segment ìˆ«ì í‘œì‹œ</td>
            <td>âœ… ì™„ë£Œ</td>
            <td class="left">BCD ë³€í™˜, Leading Zero ìƒëµ</td>
        </tr>
        <tr>
            <td class="left">LED ê²°ê³¼ í‘œì‹œ</td>
            <td>âœ… ì™„ë£Œ</td>
            <td class="left">í™€ìˆ˜=ON, ì§ìˆ˜=OFF</td>
        </tr>
        <tr>
            <td class="left">Heartbeat LED</td>
            <td>âœ… ì™„ë£Œ</td>
            <td class="left">~0.75Hz</td>
        </tr>
        <tr>
            <td class="left">í™€ì§ ê²Œì„ ì‹¤í–‰</td>
            <td>âœ… ì™„ë£Œ</td>
            <td class="left">C ì½”ë“œ â†’ BRAM ë¡œë“œ</td>
        </tr>
    </table>
    <p class="caption">[í‘œ 5-1] ê¸°ëŠ¥ êµ¬í˜„ ë‹¬ì„± ì—¬ë¶€</p>

    <div class="page-break"></div>
    <div class="page-num">- 21 -</div>

    <h2>5.2 í•©ì„± ê²°ê³¼ Report</h2>

    <h3>5.2.1 Utilization Report</h3>

    <table>
        <tr>
            <th>Resource</th>
            <th>Used</th>
            <th>Available</th>
            <th>Utilization</th>
        </tr>
        <tr>
            <td>LUT (Look-Up Table)</td>
            <td>~4,500</td>
            <td>63,400</td>
            <td>~7.1%</td>
        </tr>
        <tr>
            <td>FF (Flip-Flop)</td>
            <td>~2,500</td>
            <td>126,800</td>
            <td>~2.0%</td>
        </tr>
        <tr>
            <td>BRAM (36Kb)</td>
            <td>4</td>
            <td>135</td>
            <td>~3.0%</td>
        </tr>
        <tr>
            <td>DSP</td>
            <td>3</td>
            <td>240</td>
            <td>~1.3%</td>
        </tr>
        <tr>
            <td>IO</td>
            <td>50</td>
            <td>210</td>
            <td>~23.8%</td>
        </tr>
    </table>
    <p class="caption">[í‘œ 5-2] FPGA Resource Utilization</p>

    <h3>5.2.2 ë©´ì , ë˜ì¹˜, íƒ€ì´ë° ë¶„ì„</h3>

    <table>
        <tr>
            <th>í•­ëª©</th>
            <th>ìƒíƒœ</th>
            <th>ì„¸ë¶€ ë‚´ìš©</th>
        </tr>
        <tr>
            <td class="left">ë©´ì  (Utilization)</td>
            <td>âœ… ì–‘í˜¸</td>
            <td class="left">LUT 7.1%, FF 2.0% ì‚¬ìš©</td>
        </tr>
        <tr>
            <td class="left">ë˜ì¹˜ ë°œìƒ ì—¬ë¶€</td>
            <td>âœ… ì—†ìŒ</td>
            <td class="left">Synthesis Reportì—ì„œ Latch ë¯¸ê²€ì¶œ</td>
        </tr>
        <tr>
            <td class="left">Timing Constraints</td>
            <td>âœ… ë§Œì¡±</td>
            <td class="left">100MHz í´ëŸ­ ì œì•½ ì¶©ì¡±</td>
        </tr>
        <tr>
            <td class="left">WNS (Worst Negative Slack)</td>
            <td>âœ… ì–‘ìˆ˜</td>
            <td class="left">>0ns (Timing Met)</td>
        </tr>
    </table>
    <p class="caption">[í‘œ 5-3] ë©´ì , ë˜ì¹˜, íƒ€ì´ë° ë¶„ì„</p>

    <div class="page-break"></div>
    <div class="page-num">- 22 -</div>

    <h1>6. ë¶€ë¡</h1>

    <h2>6.1 ì‚¬ìš©ë²• ì„¤ëª…</h2>

    <ol>
        <li><strong>ë¹„íŠ¸ìŠ¤íŠ¸ë¦¼ í”„ë¡œê·¸ë˜ë°:</strong> Vivadoì—ì„œ Generate Bitstream í›„, Hardware Managerë¥¼ í†µí•´ Nexys A7 ë³´ë“œì— í”„ë¡œê·¸ë˜ë°</li>
        <li><strong>PS2 í‚¤ë³´ë“œ ì—°ê²°:</strong> Nexys A7ì˜ USB HID í¬íŠ¸ì— PS2 í‚¤ë³´ë“œ ì—°ê²°</li>
        <li><strong>VGA ëª¨ë‹ˆí„° ì—°ê²°:</strong> VGA ì¼€ì´ë¸”ë¡œ ëª¨ë‹ˆí„° ì—°ê²°</li>
        <li><strong>ë¦¬ì…‹:</strong> ë³´ë“œì˜ CPU_RESET ë²„íŠ¼(C12)ì„ ëˆŒë €ë‹¤ ë—Œ</li>
        <li><strong>ê²Œì„ í”Œë ˆì´:</strong>
            <ul>
                <li>ìˆ«ì í‚¤(0-9) ì…ë ¥ â†’ 7-Segmentì— ìˆ«ì í‘œì‹œ</li>
                <li>Backspace â†’ ë§ˆì§€ë§‰ ìë¦¬ ì‚­ì œ</li>
                <li>Enter â†’ í™€ì§ íŒë³„ â†’ VGAì— ê²°ê³¼ í‘œì‹œ</li>
            </ul>
        </li>
    </ol>

    <h2>6.2 ì†ŒìŠ¤ì½”ë“œ ëª©ë¡</h2>

    <table>
        <tr>
            <th>íŒŒì¼ëª…</th>
            <th>Lines</th>
            <th>ì„¤ëª…</th>
        </tr>
        <tr>
            <td>top.v</td>
            <td>272</td>
            <td class="left">ìµœìƒìœ„ ëª¨ë“ˆ</td>
        </tr>
        <tr>
            <td>data_path.v</td>
            <td>264</td>
            <td class="left">CPU íŒŒì´í”„ë¼ì¸ ì½”ì–´</td>
        </tr>
        <tr>
            <td>pipeline_registers.v</td>
            <td>~200</td>
            <td class="left">íŒŒì´í”„ë¼ì¸ ë ˆì§€ìŠ¤í„°</td>
        </tr>
        <tr>
            <td>mmio_controller.v</td>
            <td>108</td>
            <td class="left">MMIO ì»¨íŠ¸ë¡¤ëŸ¬</td>
        </tr>
        <tr>
            <td>pc_logic.v</td>
            <td>~100</td>
            <td class="left">PC ê³„ì‚° ë¡œì§</td>
        </tr>
        <tr>
            <td>control_unit.v</td>
            <td>~130</td>
            <td class="left">ì œì–´ ì‹ í˜¸ ìƒì„±</td>
        </tr>
        <tr>
            <td>ALU.v</td>
            <td>~50</td>
            <td class="left">ì‚°ìˆ ë…¼ë¦¬ì—°ì‚°ì¥ì¹˜</td>
        </tr>
        <tr>
            <td>vga_controller.v</td>
            <td>~150</td>
            <td class="left">VGA íƒ€ì´ë°</td>
        </tr>
        <tr>
            <td>vga_text_display.v</td>
            <td>265</td>
            <td class="left">ODD/EVEN ë Œë”ë§</td>
        </tr>
        <tr>
            <td>number_input_buffer.v</td>
            <td>155</td>
            <td class="left">ìˆ«ì ì…ë ¥ ë²„í¼</td>
        </tr>
        <tr>
            <td>ps2_kbd_top.v</td>
            <td>~40</td>
            <td class="left">PS2 í‚¤ë³´ë“œ ìµœìƒìœ„</td>
        </tr>
        <tr>
            <td>ps2_kbd_new.v</td>
            <td>~250</td>
            <td class="left">PS2 ìŠ¤ìº”ì½”ë“œ ë””ì½”ë”</td>
        </tr>
        <tr>
            <td>seven_segment_8_driver.v</td>
            <td>~75</td>
            <td class="left">7-Segment ë“œë¼ì´ë²„</td>
        </tr>
        <tr>
            <td>const.xdc</td>
            <td>102</td>
            <td class="left">í•€ í• ë‹¹</td>
        </tr>
        <tr>
            <td>game.coe</td>
            <td>~20</td>
            <td class="left">BRAM ì´ˆê¸°í™” (ê²Œì„ ì½”ë“œ)</td>
        </tr>
        <tr>
            <td>main.c</td>
            <td>29</td>
            <td class="left">í™€ì§ ê²Œì„ C ì½”ë“œ</td>
        </tr>
    </table>
    <p class="caption">[í‘œ 6-1] ì†ŒìŠ¤ì½”ë“œ ëª©ë¡</p>

    <div class="page-break"></div>
    <div class="page-num">- 23 -</div>

    <h2>6.3 ê°œë°œ ì¼ì •</h2>

    <table>
        <tr>
            <th>ë‹¨ê³„</th>
            <th>ê¸°ê°„</th>
            <th>ë‚´ìš©</th>
        </tr>
        <tr>
            <td>ë¬¸ì œì •ì˜</td>
            <td>12/06 ~ 12/07</td>
            <td class="left">í”„ë¡œì íŠ¸ ëª©í‘œ, I/O ì •ì˜, ê²Œì„ ë¡œì§ ì„¤ê³„</td>
        </tr>
        <tr>
            <td>ê°œë°œ - CPU ì½”ì–´</td>
            <td>12/07 ~ 12/09</td>
            <td class="left">darkriscv ë¶„ì„, BRAM ì—°ë™, MMIO ì„¤ê³„</td>
        </tr>
        <tr>
            <td>ê°œë°œ - I/O</td>
            <td>12/09 ~ 12/11</td>
            <td class="left">PS2, VGA, Number Buffer êµ¬í˜„</td>
        </tr>
        <tr>
            <td>êµ¬í˜„ ë° í…ŒìŠ¤íŠ¸</td>
            <td>12/11 ~ 12/12</td>
            <td class="left">í•©ì„±, ë³´ë“œ í…ŒìŠ¤íŠ¸, ë””ë²„ê¹…</td>
        </tr>
        <tr>
            <td>ë¬¸ì„œí™”</td>
            <td>12/12</td>
            <td class="left">ë³´ê³ ì„œ ì‘ì„±</td>
        </tr>
    </table>
    <p class="caption">[í‘œ 6-2] ê°œë°œ ì¼ì •</p>

    <h2>6.4 ê°œì¸ ì†Œê°</h2>

    <p>
        ë³¸ í”„ë¡œì íŠ¸ë¥¼ í†µí•´ RISC-V ì•„í‚¤í…ì²˜ì˜ íŒŒì´í”„ë¼ì¸ êµ¬ì¡°ì™€ Hazard ì²˜ë¦¬ ê¸°ë²•ì— ëŒ€í•´ ê¹Šì´ ì´í•´í•  ìˆ˜ ìˆì—ˆë‹¤.
        íŠ¹íˆ, ì˜¤í”ˆì†ŒìŠ¤ CPU ì½”ì–´(darkriscv)ë¥¼ ì‹¤ì œ FPGA ë³´ë“œì— í†µí•©í•˜ê³  ë‹¤ì–‘í•œ I/O ì¥ì¹˜(PS2 í‚¤ë³´ë“œ, VGA ëª¨ë‹ˆí„°)ë¥¼
        ì—°ê²°í•˜ëŠ” ê³¼ì •ì—ì„œ Memory-Mapped I/Oì˜ ê°œë…ê³¼ ì£¼ì†Œ ë””ì½”ë”©ì˜ ì¤‘ìš”ì„±ì„ ì²´ê°í•˜ì˜€ë‹¤.
    </p>

    <p>
        ê°œë°œ ê³¼ì •ì—ì„œ ê°€ì¥ ì–´ë ¤ì› ë˜ ë¶€ë¶„ì€ PS2 í‚¤ë³´ë“œ ì…ë ¥ê³¼ VGA ì¶œë ¥ì„ ë™ì‹œì— CPUì™€ ì—°ë™í•˜ëŠ” ê²ƒì´ì—ˆë‹¤.
        ê° ì¥ì¹˜ê°€ ì„œë¡œ ë‹¤ë¥¸ íƒ€ì´ë°ê³¼ í”„ë¡œí† ì½œì„ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì—, MMIO ì£¼ì†Œë¥¼ ì‹ ì¤‘í•˜ê²Œ ì„¤ê³„í•˜ê³ 
        ê° ëª¨ë“ˆ ê°„ì˜ ì‹ í˜¸ ì—°ê²°ì„ ì² ì €íˆ ê²€ì¦í•´ì•¼ í–ˆë‹¤. íŠ¹íˆ VGA í…ìŠ¤íŠ¸ í‘œì‹œë¥¼ ìœ„í•´ ROM ê¸°ë°˜ í°íŠ¸ ëŒ€ì‹ 
        í•˜ë“œì½”ë”©ëœ ë¹„íŠ¸ë§µ íŒ¨í„´ì„ ì‚¬ìš©í•œ ê²ƒì€ ë¦¬ì†ŒìŠ¤ íš¨ìœ¨ì„±ê³¼ êµ¬í˜„ ë‹¨ìˆœì„± ì‚¬ì´ì˜ íŠ¸ë ˆì´ë“œì˜¤í”„ë¥¼ ê³ ë¯¼í•œ ê²°ê³¼ì˜€ë‹¤.
    </p>

    <p>
        ì´ë²ˆ í”„ë¡œì íŠ¸ëŠ” ì»´í“¨í„° êµ¬ì¡° ìˆ˜ì—…ì—ì„œ ë°°ìš´ ì´ë¡ ì  ì§€ì‹ì„ ì‹¤ì œ í•˜ë“œì›¨ì–´ë¡œ êµ¬í˜„í•´ë³´ëŠ” ì†Œì¤‘í•œ ê²½í—˜ì´ì—ˆë‹¤.
        ë‹¨ìˆœíˆ ì½”ë“œë¥¼ ì‘ì„±í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼, íƒ€ì´ë°, ë¦¬ì†ŒìŠ¤, ë¬¼ë¦¬ì  ì œì•½ ë“± í•˜ë“œì›¨ì–´ íŠ¹ìœ ì˜ ê³ ë ¤ì‚¬í•­ë“¤ì„ ë‹¤ë£¨ë©´ì„œ
        ì„ë² ë””ë“œ ì‹œìŠ¤í…œ ê°œë°œìë¡œì„œì˜ ì—­ëŸ‰ì„ ê¸°ë¥¼ ìˆ˜ ìˆì—ˆë‹¤. ë˜í•œ, ìƒì„±í˜• AI(Claude)ë¥¼ í™œìš©í•˜ì—¬ ì½”ë“œ ì‘ì„±ê³¼
        ë””ë²„ê¹…ì„ íš¨ìœ¨ì ìœ¼ë¡œ ìˆ˜í–‰í•  ìˆ˜ ìˆì—ˆëŠ”ë°, AIê°€ ì œì•ˆí•œ ì½”ë“œë¥¼ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•˜ê¸°ë³´ë‹¤ëŠ”
        ì§ì ‘ ê²€í† í•˜ê³  í”„ë¡œì íŠ¸ì— ë§ê²Œ ìˆ˜ì •í•˜ëŠ” ê³¼ì •ì´ ì¤‘ìš”í•¨ì„ ê¹¨ë‹¬ì•˜ë‹¤.
    </p>

    <hr style="margin: 40px 0;">
    <p style="text-align: center; font-size: 10pt; color: #666;">
        - ë³´ê³ ì„œ ë -
    </p>

</body>

</html>